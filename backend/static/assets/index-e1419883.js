import{j as jsxRuntimeExports,r as reactExports,a as React}from"./react-c38c8745.js";import{a as renderToStaticMarkup,c as client}from"./react-dom-66cdc05c.js";import{L as Link,N as NavLink,H as HashRouter}from"./react-router-dom-903e54cb.js";import{O as Outlet,d as Routes,e as Route}from"./react-router-fbafb2d8.js";import{S as SpeechConfig,A as AudioConfig,a as SpeechSynthesizer,R as ResultReason,b as SpeechRecognizer,C as CancellationDetails,c as CancellationReason}from"./microsoft-cognitiveservices-speech-sdk-b572f3ad.js";import{p as purify}from"./dompurify-76a5efca.js";import{S as Sparkle28Filled,a as Stack,I as IconButton,E as ErrorCircle24Regular,P as PrimaryButton,T as TextField,B as BookOpenMicrophone28Regular,b as Send28Filled,c as Pivot,d as PivotItem,e as Settings24Regular,f as Text,g as Spinner,h as Panel,D as DefaultButton,C as ChoiceGroup,i as SpinButton,j as Checkbox,k as Delete24Regular,l as SparkleFilled,m as DocumentRegular,n as EditRegular,F as FolderRegular,O as OpenRegular,V as VideoRegular,o as DocumentPdfRegular,p as PeopleRegular,q as createTableColumn,u as useTableFeatures,r as useArrowNavigationGroup,s as FluentProvider,w as webLightTheme,t as Table,v as TableHeader,x as TableRow,y as TableSelectionCell,z as TableHeaderCell,A as TableBody,G as TableCell,H as TableCellLayout,J as Avatar,K as Dialog,L as DialogTrigger,M as Button,N as DialogSurface,Q as DialogTitle,R as DialogBody,U as Text$1,W as DialogActions,X as ArrowUploadRegular,Y as useTableSelection,Z as useTableSort,_ as initializeFileTypeIcons,$ as initializeIcons}from"./@fluentui-510b9db6.js";import{J,i as it}from"./@react-spring-d73e17d7.js";import{m as mainExports}from"./uploader-3eb399a9.js";import"./@upload-io-528e2b93.js";import"./@remix-run-88f74c5a.js";import"./bent-0bd6329b.js";import"./uuid-a960c1f4.js";import"./tslib-14a4c710.js";import"./@microsoft-31b40247.js";import"./tabster-dacef0e4.js";import"./keyborg-072ac2b1.js";import"./@griffel-43fc9298.js";import"./rtl-css-js-4ed993c7.js";import"./@emotion-8a8e73f6.js";import"./use-disposable-b8c3bd10.js";import"./scheduler-999fbe07.js";import"./preact-3c67df03.js";import"./upload-js-e5d126b1.js";import"./progress-smoother-d5015ad4.js";import"./classnames-7e4e529b.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))p(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&p(d)}).observe(document,{childList:!0,subtree:!0});function o(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function p(s){if(s.ep)return;s.ep=!0;const i=o(s);fetch(s.href,i)}})();const Fragment=jsxRuntimeExports.Fragment,jsx=jsxRuntimeExports.jsx,jsxs=jsxRuntimeExports.jsxs,index="",github="/assets/github-fab00c2d.svg",layout="_layout_o4bzc_1",header="_header_o4bzc_13",headerContainer="_headerContainer_o4bzc_23",headerTitleContainer="_headerTitleContainer_o4bzc_39",headerLogo="_headerLogo_o4bzc_55",headerTitle="_headerTitle_o4bzc_39",headerNavList="_headerNavList_o4bzc_73",headerNavPageLink="_headerNavPageLink_o4bzc_85",headerNavPageLinkActive="_headerNavPageLinkActive_o4bzc_113",headerNavLeftMargin="_headerNavLeftMargin_o4bzc_123",headerRightText="_headerRightText_o4bzc_131",microsoftLogo="_microsoftLogo_o4bzc_141",githubLogo="_githubLogo_o4bzc_151",styles$c={layout,header,headerContainer,headerTitleContainer,headerLogo,headerTitle,headerNavList,headerNavPageLink,headerNavPageLinkActive,headerNavLeftMargin,headerRightText,microsoftLogo,githubLogo},Layout=()=>jsxs("div",{className:styles$c.layout,children:[jsx("header",{className:styles$c.header,role:"banner",children:jsxs("div",{className:styles$c.headerContainer,children:[jsx(Link,{to:"/",className:styles$c.headerTitleContainer,children:jsx("h3",{className:styles$c.headerTitle,children:"GPT + Enterprise data | Sample"})}),jsx("nav",{children:jsxs("ul",{className:styles$c.headerNavList,children:[jsx("li",{children:jsx(NavLink,{to:"/",className:({isActive:e})=>e?styles$c.headerNavPageLinkActive:styles$c.headerNavPageLink,children:"Chat"})}),jsx("li",{className:styles$c.headerNavLeftMargin,children:jsx(NavLink,{to:"/qa",className:({isActive:e})=>e?styles$c.headerNavPageLinkActive:styles$c.headerNavPageLink,children:"Ask a question"})}),jsx("li",{className:styles$c.headerNavLeftMargin,children:jsx("a",{href:"https://aka.ms/entgptsearch",target:"_blank",title:"Github repository link",children:jsx("img",{src:github,alt:"Github logo","aria-label":"Link to github repository",width:"20px",height:"20px",className:styles$c.githubLogo})})})]})}),jsx("h4",{className:styles$c.headerRightText,children:"Azure OpenAI + Cognitive Search"})]})}),jsx(Outlet,{})]}),NoPage=()=>jsx("h1",{children:"404"}),oneshotContainer="_oneshotContainer_1x7b2_1",oneshotTopSection="_oneshotTopSection_1x7b2_15",oneshotBottomSection="_oneshotBottomSection_1x7b2_29",oneshotTitle="_oneshotTitle_1x7b2_49",oneshotQuestionInput="_oneshotQuestionInput_1x7b2_77",oneshotAnswerContainer="_oneshotAnswerContainer_1x7b2_91",oneshotAnalysisPanel="_oneshotAnalysisPanel_1x7b2_105",oneshotSettingsSeparator="_oneshotSettingsSeparator_1x7b2_115",settingsButton="_settingsButton_1x7b2_123",styles$b={oneshotContainer,oneshotTopSection,oneshotBottomSection,oneshotTitle,oneshotQuestionInput,oneshotAnswerContainer,oneshotAnalysisPanel,oneshotSettingsSeparator,settingsButton};async function askApi(e){var p,s,i,d,x,l,u,c;const t=await fetch("/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.question,approach:e.approach,overrides:{semantic_ranker:(p=e.overrides)==null?void 0:p.semanticRanker,semantic_captions:(s=e.overrides)==null?void 0:s.semanticCaptions,top:(i=e.overrides)==null?void 0:i.top,temperature:(d=e.overrides)==null?void 0:d.temperature,prompt_template:(x=e.overrides)==null?void 0:x.promptTemplate,prompt_template_prefix:(l=e.overrides)==null?void 0:l.promptTemplatePrefix,prompt_template_suffix:(u=e.overrides)==null?void 0:u.promptTemplateSuffix,exclude_category:(c=e.overrides)==null?void 0:c.excludeCategory}})}),o=await t.json();if(t.status>299||!t.ok)throw Error(o.error||"Unknown error");return o}async function chatApi(e){var p,s,i,d,x,l,u,c,h,g;const t=await fetch("/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({history:e.history,approach:e.approach,overrides:{semantic_ranker:(p=e.overrides)==null?void 0:p.semanticRanker,semantic_captions:(s=e.overrides)==null?void 0:s.semanticCaptions,top:(i=e.overrides)==null?void 0:i.top,temperature:(d=e.overrides)==null?void 0:d.temperature,prompt_template:(x=e.overrides)==null?void 0:x.promptTemplate,prompt_template_prefix:(l=e.overrides)==null?void 0:l.promptTemplatePrefix,prompt_template_suffix:(u=e.overrides)==null?void 0:u.promptTemplateSuffix,exclude_category:(c=e.overrides)==null?void 0:c.excludeCategory,suggest_followup_questions:(h=e.overrides)==null?void 0:h.suggestFollowupQuestions,use_bing_search:(g=e.overrides)==null?void 0:g.useBingSearch}})}),o=await t.json();if(t.status>299||!t.ok)throw Error(o.error||"Unknown error");return o}async function readApi(e){const t="",o="southcentralus";var p=SpeechConfig.fromSubscription(t,o);const s=AudioConfig.fromDefaultSpeakerOutput();p.speechSynthesisVoiceName="zh-CN-YunxiNeural";const i=new SpeechSynthesizer(p,s),x=e.answer.replace(/\[[^\]]*\]/g,"");console.log(e.answer),i.speakTextAsync(x,function(l){l.reason===ResultReason.SynthesizingAudioCompleted?console.log("synthesis finished."):console.error("Speech synthesis canceled, "+l.errorDetails+`
Did you set the speech resource key and region values?`),i.close()},function(l){console.trace("err - "+l),i.close()})}function getCitationFilePath(e){return`/content/${e}`}var Approaches=(e=>(e.RetrieveThenRead="rtr",e.ReadRetrieveRead="rrr",e.ReadDecomposeAsk="rda",e))(Approaches||{});const answerContainer="_answerContainer_1tryd_1",answerLogo="_answerLogo_1tryd_17",answerText="_answerText_1tryd_25",selected="_selected_1tryd_43",citationLearnMore="_citationLearnMore_1tryd_51",citation="_citation_1tryd_51",followupQuestionsList="_followupQuestionsList_1tryd_95",followupQuestionLearnMore="_followupQuestionLearnMore_1tryd_103",followupQuestion="_followupQuestion_1tryd_95",supContainer="_supContainer_1tryd_141",retryButton="_retryButton_1tryd_199",loadingdots="_loadingdots_1tryd_243",loading="_loading_1tryd_243",styles$a={answerContainer,answerLogo,answerText,selected,citationLearnMore,citation,followupQuestionsList,followupQuestionLearnMore,followupQuestion,supContainer,retryButton,loadingdots,loading};function parseAnswerToHtml(e,t){const o=[],p=[];let s=e.replace(/<<([^>>]+)>>/g,(l,u)=>(p.push(u),""));s=s.trim();const i=s.split(/\[([^\]]+)\]+\(([^\)]+)\)/g);console.log(i);let d=s.match(/\[([^\]]+)\]+\(([^\)]+)\)/g);return console.log(d),d&&d.map((l,u)=>{const c=l.split("]")[0].replace("[",""),h=l.split("]")[1].replace("(","").replace(")","");console.log(c),console.log(h),o.push({id:u,name:c,path:h})}),{answerHtml:i.map((l,u)=>{if(u%3===0)return l;if(u%3==1){let c=o.find(S=>S.name==l),h=c?c.id:-1;h!==-1?h=c?c.id+1:-1:h=o.length;const g=getCitationFilePath(l);return renderToStaticMarkup(jsx("a",{className:"supContainer",title:l,onClick:()=>t(g),children:jsx("sup",{children:h})}))}else return""}).join(""),citations:o,followupQuestions:p}}const AnswerIcon=()=>jsx(Sparkle28Filled,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),Answer=({answer:e,isSelected:t,onCitationClicked:o,onThoughtProcessClicked:p,onSupportingContentClicked:s,onFollowupQuestionClicked:i,onReadAnswerClicked:d,showFollowupQuestions:x})=>{const l=reactExports.useMemo(()=>parseAnswerToHtml(e.answer,o),[e]),u=purify.sanitize(l.answerHtml);return jsxs(Stack,{className:`${styles$a.answerContainer} ${t&&styles$a.selected}`,verticalAlign:"space-between",children:[jsx(Stack.Item,{children:jsxs(Stack,{horizontal:!0,horizontalAlign:"space-between",children:[jsx(AnswerIcon,{}),jsxs("div",{children:[jsx(IconButton,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>p(),disabled:!e.thoughts}),jsx(IconButton,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>s(),disabled:!e.data_points.length}),jsx(IconButton,{style:{color:"black"},iconProps:{iconName:"ReadOutLoud"},title:"Read answer",ariaLabel:"Read answer",onClick:()=>d(),disabled:!e.answer})]})]})}),jsx(Stack.Item,{grow:!0,children:jsx("div",{className:styles$a.answerText,dangerouslySetInnerHTML:{__html:u}})}),!!l.citations.length&&jsx(Stack.Item,{children:jsxs(Stack,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[jsx("span",{className:styles$a.citationLearnMore,children:"来源:"}),l.citations.map((c,h)=>{const g=c.path;return jsx("a",{className:styles$a.citation,title:c.name,onClick:()=>o(g),children:`${++h}. ${c.name}`},h)})]})}),!!l.followupQuestions.length&&x&&i&&jsx(Stack.Item,{children:jsxs(Stack,{horizontal:!0,wrap:!0,className:`${l.citations.length?styles$a.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[jsx("span",{className:styles$a.followupQuestionLearnMore,children:"您可能还想问:"}),l.followupQuestions.map((c,h)=>jsx("a",{className:styles$a.followupQuestion,title:c,onClick:()=>i(c),children:`${c}`},h))]})})]})},AnswerLoading=()=>{const e=J({from:{opacity:0},to:{opacity:1}});return jsx(it.div,{style:{...e},children:jsxs(Stack,{className:styles$a.answerContainer,verticalAlign:"space-between",children:[jsx(AnswerIcon,{}),jsx(Stack.Item,{grow:!0,children:jsxs("p",{className:styles$a.answerText,children:["正在生成回答",jsx("span",{className:styles$a.loadingdots})]})})]})})},AnswerError=({error:e,onRetry:t})=>jsxs(Stack,{className:styles$a.answerContainer,verticalAlign:"space-between",children:[jsx(ErrorCircle24Regular,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),jsx(Stack.Item,{grow:!0,children:jsx("p",{className:styles$a.answerText,children:e})}),jsx(PrimaryButton,{className:styles$a.retryButton,onClick:t,text:"Retry"})]}),questionInputContainer="_questionInputContainer_wokwf_1",questionInputTextArea="_questionInputTextArea_wokwf_19",questionInputButtonsContainer="_questionInputButtonsContainer_wokwf_29",questionInputSendButton="_questionInputSendButton_wokwf_41",questionInputSendButtonDisabled="_questionInputSendButtonDisabled_wokwf_49",styles$9={questionInputContainer,questionInputTextArea,questionInputButtonsContainer,questionInputSendButton,questionInputSendButtonDisabled},QuestionInput=({onSend:e,disabled:t,placeholder:o,clearOnSend:p})=>{const[s,i]=reactExports.useState(""),d=()=>{if(t||!s.trim()){console.log("send disabled"),console.log("question: "+s);return}e(s),p&&i("")},x=()=>{const h="",g="southcentralus";var S=SpeechConfig.fromSubscription(h,g);const C=AudioConfig.fromDefaultMicrophoneInput();S.speechRecognitionLanguage="zh-CN";const k=new SpeechRecognizer(S,C);k.recognizeOnceAsync(r=>{switch(r.reason){case ResultReason.RecognizedSpeech:console.log(`RECOGNIZED: Text=${r.text}`),i(r.text);break;case ResultReason.NoMatch:console.log("NOMATCH: Speech could not be recognized.");break;case ResultReason.Canceled:const m=CancellationDetails.fromResult(r);console.log(`CANCELED: Reason=${m.reason}`),m.reason==CancellationReason.Error&&(console.log(`CANCELED: ErrorCode=${m.ErrorCode}`),console.log(`CANCELED: ErrorDetails=${m.errorDetails}`),console.log("CANCELED: Did you set the speech resource key and region values?"));break}k.close()})},l=h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),d())},u=(h,g)=>{g?g.length<=1e3&&i(g):i("")},c=t||!s.trim();return jsxs(Stack,{horizontal:!0,className:styles$9.questionInputContainer,children:[jsx(TextField,{className:styles$9.questionInputTextArea,placeholder:o,multiline:!0,resizable:!1,borderless:!0,value:s,onChange:u,onKeyDown:l}),jsxs("div",{className:styles$9.questionInputButtonsContainer,children:[jsx("div",{className:`${styles$9.questionInputSendButton} ${c?styles$9.questionInputSendButtonDisabled:""}`,"aria-label":"语音输入",onClick:x,children:jsx(BookOpenMicrophone28Regular,{primaryFill:"rgba(115, 118, 225, 1)"})}),jsx("div",{className:`${styles$9.questionInputSendButton} ${c?styles$9.questionInputSendButtonDisabled:""}`,"aria-label":"提问按钮",onClick:d,children:jsx(Send28Filled,{primaryFill:"rgba(115, 118, 225, 1)"})})]})]})},examplesNavList="_examplesNavList_v5q0z_1",example="_example_v5q0z_1",exampleText="_exampleText_v5q0z_53",styles$8={examplesNavList,example,exampleText},Example=({text:e,value:t,onClick:o})=>jsx("div",{className:styles$8.example,onClick:()=>o(t),children:jsx("p",{className:styles$8.exampleText,children:e})}),EXAMPLES=[{text:"试剂盘有异响是什么原因，怎么解决?",value:"试剂盘有异响是什么原因，怎么解决?"},{text:"建立真空失败是什么原因？怎么解决",value:"建立真空失败是什么原因？怎么解决"},{text:"面壳的下单编码和物料名称有哪些",value:"面壳的下单编码和物料名称有哪些"}],ExampleList=({onExampleClicked:e})=>jsx("ul",{className:styles$8.examplesNavList,children:EXAMPLES.map((t,o)=>jsx("li",{children:jsx(Example,{text:t.text,value:t.value,onClick:e})},o))}),thoughtProcess="_thoughtProcess_exr0t_1",styles$7={thoughtProcess};function parseSupportingContentItem(item){const itemj=eval(item),title=itemj.sourcepage,content=itemj.content,url=itemj.sourcepage_path;return{title,content,url:url||""}}const supportingContentNavList="_supportingContentNavList_ekyxv_1",supportingContentItem="_supportingContentItem_ekyxv_17",supportingContentItemHeader="_supportingContentItemHeader_ekyxv_41",supportingContentItemText="_supportingContentItemText_ekyxv_49",styles$6={supportingContentNavList,supportingContentItem,supportingContentItemHeader,supportingContentItemText},SupportingContent=({supportingContent})=>{console.log("supportingContent"+supportingContent);const supportingContentList=eval(supportingContent);return console.log("supportingContentList"+supportingContentList),jsx("ul",{className:styles$6.supportingContentNavList,children:supportingContentList.map((e,t)=>{const o=parseSupportingContentItem(e);return jsxs("li",{className:styles$6.supportingContentItem,children:[jsx("h4",{className:styles$6.supportingContentItemHeader,children:o.title}),jsx("p",{className:styles$6.supportingContentItemText,children:o.content}),jsx("a",{className:styles$6.supportingContentItemText,href:o.url,target:"_blank",children:o.url})]},t)})})};var AnalysisPanelTabs=(e=>(e.ThoughtProcessTab="thoughtProcess",e.SupportingContentTab="supportingContent",e.CitationTab="citation",e))(AnalysisPanelTabs||{});const pivotItemDisabledStyle={disabled:!0,style:{color:"grey"}},AnalysisPanel=({answer:e,activeTab:t,activeCitation:o,citationHeight:p,className:s,onActiveTabChanged:i})=>{const d=!e.thoughts,x=!e.data_points.length,l=!o,u=purify.sanitize(e.thoughts);return jsxs(Pivot,{className:s,selectedKey:t,onLinkClick:c=>c&&i(c.props.itemKey),children:[jsx(PivotItem,{itemKey:AnalysisPanelTabs.ThoughtProcessTab,headerText:"思维过程",headerButtonProps:d?pivotItemDisabledStyle:void 0,children:jsx("div",{className:styles$7.thoughtProcess,dangerouslySetInnerHTML:{__html:u}})}),jsx(PivotItem,{itemKey:AnalysisPanelTabs.SupportingContentTab,headerText:"支持内容",headerButtonProps:x?pivotItemDisabledStyle:void 0,children:jsx(SupportingContent,{supportingContent:e.data_points})}),jsx(PivotItem,{itemKey:AnalysisPanelTabs.CitationTab,headerText:"引用",headerButtonProps:l?pivotItemDisabledStyle:void 0,children:jsx("iframe",{title:"引用",src:o,width:"100%",height:p})})]})},container$5="_container_1k5c7_1",styles$5={container:container$5},SettingsButton=({className:e,onClick:t})=>jsxs("div",{className:`${styles$5.container} ${e??""}`,onClick:t,children:[jsx(Settings24Regular,{}),jsx(Text,{children:"开发人员配置"})]}),OneShot=()=>{const[e,t]=reactExports.useState(!1),[o,p]=reactExports.useState(Approaches.ReadDecomposeAsk),[s,i]=reactExports.useState(""),[d,x]=reactExports.useState(""),[l,u]=reactExports.useState(""),[c,h]=reactExports.useState(3),[g,S]=reactExports.useState(!1),[C,k]=reactExports.useState(!1),[r,m]=reactExports.useState(""),y=reactExports.useRef(""),[_,j]=reactExports.useState(!1),[T,P]=reactExports.useState(),[w,N]=reactExports.useState(),[v,R]=reactExports.useState(),[A,b]=reactExports.useState(void 0),$=async a=>{y.current=a,T&&P(void 0),j(!0),R(void 0),b(void 0);try{const n={question:a,approach:o,overrides:{promptTemplate:s.length===0?void 0:s,promptTemplatePrefix:d.length===0?void 0:d,promptTemplateSuffix:l.length===0?void 0:l,excludeCategory:r.length===0?void 0:r,top:c,semanticRanker:g,semanticCaptions:C}},f=await askApi(n);N(f)}catch(n){P(n)}finally{j(!1)}},L=(a,n)=>{i(n||"")},B=(a,n)=>{x(n||"")},D=(a,n)=>{u(n||"")},M=(a,n)=>{h(parseInt(n||"3"))},F=(a,n)=>{p((n==null?void 0:n.key)||Approaches.RetrieveThenRead)},q=(a,n)=>{S(!!n)},z=(a,n)=>{k(!!n)},U=(a,n)=>{m(n||"")},Q=a=>{$(a)},O=a=>{v===a&&A===AnalysisPanelTabs.CitationTab?b(void 0):(R(a),b(AnalysisPanelTabs.CitationTab))},E=a=>{b(A===a?void 0:a)},I=()=>{alert("onReadAnswerClicked")},G=[{key:Approaches.RetrieveThenRead,text:"Retrieve-Then-Read"},{key:Approaches.ReadRetrieveRead,text:"Read-Retrieve-Read"},{key:Approaches.ReadDecomposeAsk,text:"Read-Decompose-Ask"}];return jsxs("div",{className:styles$b.oneshotContainer,children:[jsxs("div",{className:styles$b.oneshotTopSection,children:[jsx(SettingsButton,{className:styles$b.settingsButton,onClick:()=>t(!e)}),jsx("h1",{className:styles$b.oneshotTitle,children:"Ask your data"}),jsx("div",{className:styles$b.oneshotQuestionInput,children:jsx(QuestionInput,{placeholder:"示例:面条是否可以用体外模拟进行GI测试？?",disabled:_,onSend:a=>$(a)})})]}),jsxs("div",{className:styles$b.oneshotBottomSection,children:[_&&jsx(Spinner,{label:"正在生成回答"}),!y.current&&jsx(ExampleList,{onExampleClicked:Q}),!_&&w&&!T&&jsx("div",{className:styles$b.oneshotAnswerContainer,children:jsx(Answer,{answer:w,onCitationClicked:a=>O(a),onThoughtProcessClicked:()=>E(AnalysisPanelTabs.ThoughtProcessTab),onSupportingContentClicked:()=>E(AnalysisPanelTabs.SupportingContentTab),onReadAnswerClicked:()=>I()})}),T?jsx("div",{className:styles$b.oneshotAnswerContainer,children:jsx(AnswerError,{error:T.toString(),onRetry:()=>$(y.current)})}):null,A&&w&&jsx(AnalysisPanel,{className:styles$b.oneshotAnalysisPanel,activeCitation:v,onActiveTabChanged:a=>E(a),citationHeight:"600px",answer:w,activeTab:A})]}),jsxs(Panel,{headerText:"配置",isOpen:e,isBlocking:!1,onDismiss:()=>t(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>jsx(DefaultButton,{onClick:()=>t(!1),children:"Close"}),isFooterAtBottom:!0,children:[jsx(ChoiceGroup,{className:styles$b.oneshotSettingsSeparator,label:"方式",options:G,defaultSelectedKey:o,onChange:F}),(o===Approaches.RetrieveThenRead||o===Approaches.ReadDecomposeAsk)&&jsx(TextField,{className:styles$b.oneshotSettingsSeparator,defaultValue:s,label:"更改提问模板",multiline:!0,autoAdjustHeight:!0,onChange:L}),o===Approaches.ReadRetrieveRead&&jsxs(Fragment,{children:[jsx(TextField,{className:styles$b.oneshotSettingsSeparator,defaultValue:d,label:"更改提问前缀模板",multiline:!0,autoAdjustHeight:!0,onChange:B}),jsx(TextField,{className:styles$b.oneshotSettingsSeparator,defaultValue:l,label:"更改提问后缀模板",multiline:!0,autoAdjustHeight:!0,onChange:D})]}),jsx(SpinButton,{className:styles$b.oneshotSettingsSeparator,label:"最多从搜索中返回的条目数量:",min:1,max:50,defaultValue:c.toString(),onChange:M}),jsx(TextField,{className:styles$b.oneshotSettingsSeparator,label:"排除类别",onChange:U}),jsx(Checkbox,{className:styles$b.oneshotSettingsSeparator,checked:g,label:"使用语义搜索",onChange:q}),jsx(Checkbox,{className:styles$b.oneshotSettingsSeparator,checked:C,label:"使用查询上下文摘要而不是整个文档",onChange:z,disabled:!g})]})]})},container$4="_container_1qf1y_1",chatRoot="_chatRoot_1qf1y_15",chatContainer="_chatContainer_1qf1y_25",chatEmptyState="_chatEmptyState_1qf1y_41",chatEmptyStateTitle="_chatEmptyStateTitle_1qf1y_61",chatEmptyStateSubtitle="_chatEmptyStateSubtitle_1qf1y_75",chatMessageStream="_chatMessageStream_1qf1y_107",chatMessageGpt="_chatMessageGpt_1qf1y_131",chatMessageGptMinWidth="_chatMessageGptMinWidth_1qf1y_145",chatInput="_chatInput_1qf1y_155",chatAnalysisPanel="_chatAnalysisPanel_1qf1y_181",chatSettingsSeparator="_chatSettingsSeparator_1qf1y_197",loadingLogo="_loadingLogo_1qf1y_205",commandsContainer="_commandsContainer_1qf1y_213",commandButton="_commandButton_1qf1y_223",styles$4={container:container$4,chatRoot,chatContainer,chatEmptyState,chatEmptyStateTitle,chatEmptyStateSubtitle,chatMessageStream,chatMessageGpt,chatMessageGptMinWidth,chatInput,chatAnalysisPanel,chatSettingsSeparator,loadingLogo,commandsContainer,commandButton},container$3="_container_u4tj7_1",message="_message_u4tj7_17",styles$3={container:container$3,message},UserChatMessage=({message:e})=>jsx("div",{className:styles$3.container,children:jsx("div",{className:styles$3.message,children:e})}),container$2="_container_7708a_1",disabled="_disabled_7708a_15",styles$2={container:container$2,disabled},ClearChatButton=({className:e,disabled:t,onClick:o})=>jsxs("div",{className:`${styles$2.container} ${e??""} ${t&&styles$2.disabled}`,onClick:o,children:[jsx(Delete24Regular,{}),jsx(Text,{children:"清空对话"})]}),Chat=()=>{const[e,t]=reactExports.useState(!1),[o,p]=reactExports.useState(""),[s,i]=reactExports.useState(6),[d,x]=reactExports.useState(!0),[l,u]=reactExports.useState(!0),[c,h]=reactExports.useState(""),[g,S]=reactExports.useState(!0),[C,k]=reactExports.useState(!1),r=reactExports.useRef(""),m=reactExports.useRef(null),[y,_]=reactExports.useState(!1),[j,T]=reactExports.useState(),[P,w]=reactExports.useState(),[N,v]=reactExports.useState(void 0),[R,A]=reactExports.useState(0),[b,$]=reactExports.useState([]),L=async a=>{r.current=a,j&&T(void 0),_(!0),w(void 0),v(void 0);try{const f={history:[...b.map(H=>({user:H[0],bot:H[1].answer})),{user:a,bot:void 0}],approach:Approaches.ReadRetrieveRead,overrides:{promptTemplate:o.length===0?void 0:o,excludeCategory:c.length===0?void 0:c,top:s,semanticRanker:d,semanticCaptions:l,suggestFollowupQuestions:g,useBingSearch:C}},V=await chatApi(f);$([...b,[a,V]])}catch(n){T(n)}finally{_(!1)}},B=()=>{r.current="",j&&T(void 0),w(void 0),v(void 0),$([])};reactExports.useEffect(()=>{var a;return(a=m.current)==null?void 0:a.scrollIntoView({behavior:"smooth"})},[y]);const D=(a,n)=>{p(n||"")},M=(a,n)=>{i(parseInt(n||"3"))},F=(a,n)=>{x(!!n)},q=(a,n)=>{u(!!n)},z=(a,n)=>{h(n||"")},U=(a,n)=>{S(!!n)},Q=(a,n)=>{k(!!n)},O=a=>{L(a)},E=(a,n)=>{P===a&&N===AnalysisPanelTabs.CitationTab&&R===n?v(void 0):(w(a),v(AnalysisPanelTabs.CitationTab)),A(n)},I=(a,n)=>{v(N===a&&R===n?void 0:a),A(n)},G=async(a,n)=>{A(n);try{const f={answer:a.answer};await readApi(f)}catch(f){T(f)}finally{_(!1)}};return jsxs("div",{className:styles$4.container,children:[jsxs("div",{className:styles$4.commandsContainer,children:[jsx(ClearChatButton,{className:styles$4.commandButton,onClick:B,disabled:!r.current||y}),jsx(SettingsButton,{className:styles$4.commandButton,onClick:()=>t(!e)})]}),jsxs("div",{className:styles$4.chatRoot,children:[jsxs("div",{className:styles$4.chatContainer,children:[r.current?jsxs("div",{className:styles$4.chatMessageStream,children:[b.map((a,n)=>jsxs("div",{children:[jsx(UserChatMessage,{message:a[0]}),jsx("div",{className:styles$4.chatMessageGpt,children:jsx(Answer,{answer:a[1],isSelected:R===n&&N!==void 0,onCitationClicked:f=>E(f,n),onThoughtProcessClicked:()=>I(AnalysisPanelTabs.ThoughtProcessTab,n),onSupportingContentClicked:()=>I(AnalysisPanelTabs.SupportingContentTab,n),onFollowupQuestionClicked:f=>L(f),onReadAnswerClicked:()=>G(a[1],n),showFollowupQuestions:g&&b.length-1===n},n)})]},n)),y&&jsxs(Fragment,{children:[jsx(UserChatMessage,{message:r.current}),jsx("div",{className:styles$4.chatMessageGptMinWidth,children:jsx(AnswerLoading,{})})]}),j?jsxs(Fragment,{children:[jsx(UserChatMessage,{message:r.current}),jsx("div",{className:styles$4.chatMessageGptMinWidth,children:jsx(AnswerError,{error:j.toString(),onRetry:()=>L(r.current)})})]}):null,jsx("div",{ref:m})]}):jsxs("div",{className:styles$4.chatEmptyState,children:[jsx(SparkleFilled,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),jsx("h1",{className:styles$4.chatEmptyStateTitle,children:"Chat with your data"}),jsx("h2",{className:styles$4.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),jsx(ExampleList,{onExampleClicked:O})]}),jsx("div",{className:styles$4.chatInput,children:jsx(QuestionInput,{clearOnSend:!0,placeholder:"输入问题",disabled:y,onSend:a=>L(a)})})]}),b.length>0&&N&&jsx(AnalysisPanel,{className:styles$4.chatAnalysisPanel,activeCitation:P,onActiveTabChanged:a=>I(a,R),citationHeight:"810px",answer:b[R][1],activeTab:N}),jsxs(Panel,{headerText:"配置",isOpen:e,isBlocking:!1,onDismiss:()=>t(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>jsx(DefaultButton,{onClick:()=>t(!1),children:"Close"}),isFooterAtBottom:!0,children:[jsx(TextField,{className:styles$4.chatSettingsSeparator,defaultValue:o,label:"更改提问模板",multiline:!0,autoAdjustHeight:!0,onChange:D}),jsx(SpinButton,{className:styles$4.chatSettingsSeparator,label:"最多从搜索中返回的条目数量:",min:1,max:50,defaultValue:s.toString(),onChange:M}),jsx(TextField,{className:styles$4.chatSettingsSeparator,label:"排除类别",onChange:z}),jsx(Checkbox,{className:styles$4.chatSettingsSeparator,checked:d,label:"使用语义搜索",onChange:F}),jsx(Checkbox,{className:styles$4.chatSettingsSeparator,checked:l,label:"使用查询上下文摘要而不是整个文档",onChange:q,disabled:!d}),jsx(Checkbox,{className:styles$4.chatSettingsSeparator,checked:g,label:"建议后续问题",onChange:U}),jsx(Checkbox,{className:styles$4.chatSettingsSeparator,checked:C,label:"启用Bing搜索",onChange:Q})]})]})]})},container$1="_container_gmjn7_1",filesViewer="_filesViewer_gmjn7_15",fileContainer="_fileContainer_gmjn7_25",styles$1={container:container$1,filesViewer,fileContainer},processButtonGroup="_processButtonGroup_15n94_1",container="_container_15n94_21",styles={processButtonGroup,container};mainExports.Uploader({apiKey:"free"});const items=[{file:{label:"Meeting notes",icon:jsx(DocumentRegular,{})},author:{label:"Max Mustermann",status:"available"},lastUpdated:{label:"7h ago",timestamp:3},lastUpdate:{label:"You edited this",icon:jsx(EditRegular,{})},filePath:{label:"http://xxx.blob.azure.com/abc.pdf"}},{file:{label:"Thursday presentation",icon:jsx(FolderRegular,{})},author:{label:"Erika Mustermann",status:"busy"},lastUpdated:{label:"Yesterday at 1:45 PM",timestamp:2},lastUpdate:{label:"You recently opened this",icon:jsx(OpenRegular,{})},filePath:{label:"http://xxx.blob.azure.com/abc.pdf"}},{file:{label:"Training recording",icon:jsx(VideoRegular,{})},author:{label:"John Doe",status:"away"},lastUpdated:{label:"Yesterday at 1:45 PM",timestamp:2},lastUpdate:{label:"You recently opened this",icon:jsx(OpenRegular,{})},filePath:{label:"http://xxx.blob.azure.com/abc.pdf"}},{file:{label:"Purchase order",icon:jsx(DocumentPdfRegular,{})},author:{label:"Jane Doe",status:"offline"},lastUpdated:{label:"Tue at 9:30 AM",timestamp:1},lastUpdate:{label:"You shared this in a Teams chat",icon:jsx(PeopleRegular,{})},filePath:{label:"http://xxx.blob.azure.com/abc.pdf"}}],columns=[createTableColumn({columnId:"file",compare:(e,t)=>e.file.label.localeCompare(t.file.label)}),createTableColumn({columnId:"author",compare:(e,t)=>e.author.label.localeCompare(t.author.label)}),createTableColumn({columnId:"lastUpdated",compare:(e,t)=>e.lastUpdated.timestamp-t.lastUpdated.timestamp}),createTableColumn({columnId:"lastUpdate",compare:(e,t)=>e.lastUpdate.label.localeCompare(t.lastUpdate.label)}),createTableColumn({columnId:"filePath",compare:(e,t)=>e.filePath.label.localeCompare(t.filePath.label)})],DataGrid=()=>{const{getRows:e,selection:{allRowsSelected:t,someRowsSelected:o,toggleAllRows:p,toggleRow:s,isRowSelected:i},sort:{getSortDirection:d,toggleColumnSort:x,sort:l}}=useTableFeatures({columns,items},[useTableSelection({selectionMode:"multiselect",defaultSelectedItems:new Set([])}),useTableSort({defaultSortState:{sortColumn:"file",sortDirection:"ascending"}})]),[u,c]=reactExports.useState(),h=r=>{r.target.files&&r.target.files&&c(r.target.files[0])},g=()=>{if(!u)return;console.log(u);const r=new FormData;r.append("name",u.name),r.append("file",u),fetch("/uploadFile",{method:"POST",body:r,headers:{}}).then(m=>{m.json()}).then(m=>console.log(m)).then(m=>console.log(m))},S=l(e(r=>{const m=i(r.rowId);return{...r,onClick:y=>s(y,r.rowId),onKeyDown:y=>{y.key===" "&&(y.preventDefault(),s(y,r.rowId))},selected:m,appearance:m?"brand":"none"}})),C=r=>({onClick:m=>{x(m,r)},sortDirection:d(r)}),k=useArrowNavigationGroup({axis:"grid"});return jsx("div",{className:styles.container,children:jsxs(FluentProvider,{theme:webLightTheme,children:[jsxs(Table,{...k,role:"grid",sortable:!0,"aria-label":"DataGrid implementation with Table primitives",children:[jsx(TableHeader,{children:jsxs(TableRow,{children:[jsx(TableSelectionCell,{checked:t?!0:o?"mixed":!1,"aria-checked":t?!0:o?"mixed":!1,role:"checkbox",onClick:p,checkboxIndicator:{"aria-label":"Select all rows "}}),jsx(TableHeaderCell,{...C("file"),children:"File"}),jsx(TableHeaderCell,{...C("author"),children:"Author"}),jsx(TableHeaderCell,{...C("lastUpdated"),children:"Last updated"}),jsx(TableHeaderCell,{...C("lastUpdate"),children:"Last update"}),jsx(TableHeaderCell,{...C("filePath"),children:"Path"})]})}),jsx(TableBody,{children:S.map(({item:r,selected:m,onClick:y,onKeyDown:_,appearance:j})=>jsxs(TableRow,{onClick:y,onKeyDown:_,"aria-selected":m,appearance:j,children:[jsx(TableSelectionCell,{role:"gridcell","aria-selected":m,checked:m,checkboxIndicator:{"aria-label":"Select row"}}),jsx(TableCell,{tabIndex:0,role:"gridcell","aria-selected":m,children:jsx(TableCellLayout,{media:r.file.icon,children:r.file.label})}),jsx(TableCell,{tabIndex:0,role:"gridcell",children:jsx(TableCellLayout,{media:jsx(Avatar,{"aria-label":r.author.label,name:r.author.label,badge:{status:r.author.status}}),children:r.author.label})}),jsx(TableCell,{tabIndex:0,role:"gridcell",children:r.lastUpdated.label}),jsx(TableCell,{tabIndex:0,role:"gridcell",children:jsx(TableCellLayout,{media:r.lastUpdate.icon,children:r.lastUpdate.label})}),jsx(TableCell,{tabIndex:0,role:"gridcell",children:jsx(TableCellLayout,{children:r.filePath.label})})]},r.file.label))})]}),jsxs("div",{className:styles.processButtonGroup,children:[jsxs(Dialog,{children:[jsx(DialogTrigger,{disableButtonEnhancement:!0,children:jsx(Button,{children:"处理选中文档"})}),jsxs(DialogSurface,{children:[jsx(DialogTitle,{children:"处理选中文档"}),jsx(DialogBody,{children:jsx(Text$1,{children:"确认处理选中文档? 这将重新处理选中文档。"})}),jsxs(DialogActions,{children:[jsx(DialogTrigger,{disableButtonEnhancement:!0,children:jsx(Button,{appearance:"secondary",children:"取消"})}),jsx(Button,{appearance:"primary",children:"确认"})]})]})]}),jsxs(Dialog,{children:[jsx(DialogTrigger,{disableButtonEnhancement:!0,children:jsx(Button,{children:"处理全部文档"})}),jsxs(DialogSurface,{children:[jsx(DialogTitle,{children:"处理全部文档"}),jsx(DialogBody,{children:jsx(Text$1,{children:"确认处理全部文档? 这将重新处理全部文档。"})}),jsxs(DialogActions,{children:[jsx(DialogTrigger,{disableButtonEnhancement:!0,children:jsx(Button,{appearance:"secondary",children:"取消"})}),jsx(Button,{appearance:"primary",children:"确认"})]})]})]}),jsxs(Dialog,{children:[jsx(DialogTrigger,{disableButtonEnhancement:!0,children:jsx(Button,{icon:jsx(ArrowUploadRegular,{}),children:"上传新文档"})}),jsxs(DialogSurface,{children:[jsx(DialogTitle,{children:"上传新文档"}),jsxs(DialogBody,{children:[jsx("input",{type:"file",onChange:h,name:"file"}),jsx("div",{children:u&&`${u.name} - ${u.type}`})]}),jsxs(DialogActions,{children:[jsx(DialogTrigger,{disableButtonEnhancement:!0,children:jsx(Button,{appearance:"secondary",children:"取消"})}),jsx(Button,{appearance:"primary",onClick:g,children:"确认"})]})]})]})]})]})})},FilesViewer=()=>{const[e,t]=reactExports.useState(),o=s=>{s.target.files&&t(s.target.files[0])},p=()=>{e&&(new FormData,fetch("/uploadFile",{method:"POST",body:e,headers:{"content-type":e.type,"content-length":`${e.size}`}}).then(s=>{s.json()}).then(s=>console.log(s)).then(s=>console.log(s)))};return jsx("div",{children:jsxs("div",{children:[jsx("div",{className:styles$1.filesViewer,children:jsx(DataGrid,{})}),jsxs("div",{children:[jsx("input",{type:"file",onChange:o}),jsx("div",{children:e&&`${e.name} - ${e.type}`}),jsx("button",{onClick:p,children:"Upload"})]})]})})};initializeFileTypeIcons();initializeIcons();function App(){return jsx(HashRouter,{children:jsx(Routes,{children:jsxs(Route,{path:"/",element:jsx(Layout,{}),children:[jsx(Route,{index:!0,element:jsx(Chat,{})}),jsx(Route,{path:"qa",element:jsx(OneShot,{})}),jsx(Route,{path:"files",element:jsx(FilesViewer,{})}),jsx(Route,{path:"*",element:jsx(NoPage,{})})]})})})}client.createRoot(document.getElementById("root")).render(jsx(React.StrictMode,{children:jsx(App,{})}));
//# sourceMappingURL=index-e1419883.js.map
